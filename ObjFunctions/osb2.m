function [f,gradf,fvec,J] = osb2(n,m,x,evalDer)
% Osborne 2 function (19)
% --------------------------------------
% Dimensions: n = 11, m = 65
% Standard starting point: (1.3,0.65,0.7,0.6,3,5,7,2,4.5,5.5)
% Minima: f=4.01377...10^(-2) 
%   at (1.31,.4315,.6336,.5993,.7539,.9056,1.3651,4.8248,2.3988,
%   4.5689,5.6754)
%
% 2017-03-31 by Preston Donovan

J = [];
gradf = [];

y = [1.366  1.191  1.112  1.013  .991  ...
      .885   .831   .847   .786  .725  ...
      .746   .679   .608   .655  .616   ...
      .606   .602   .626   .651  .724  ...
      .649   .649   .694   .644  .624   ...
      .661   .612   .558   .533  .495  ...
      .500   .423   .395   .375  .372   ...
      .391   .396   .405   .428  .429   ...
      .523   .562   .607   .653  .672   ...
      .708   .633   .668   .645  .632   ...
      .591   .559   .597   .625  .739   ...
      .710   .729   .720   .636  .581   ...
      .428   .292   .162   .098  .054 ]';

t = ((1:m)'-1)./10;

t09= t - x(9);
t10= t - x(10);
t11= t - x(11);
s09= t09.^2;
s10= t10.^2;
s11= t11.^2;
e1= exp(-t*x(5));
e2= exp(-s09*x(6));
e3= exp(-s10*x(7));
e4= exp(-s11*x(8));

r2=x(2)*e2;
r3=x(3)*e3;
r4=x(4)*e4;

fvec = y - (x(1)*e1 + ...
            x(2)*e2 + ...
            x(3)*e3 + ...
            x(4)*e4);
         
f = fvec' * fvec;

if evalDer == 1

    J = [e1, e2, e3, e4, ...
        -x(1)*t.*e1, -s09.*r2, -s10.*r3, -s11.*r4, ...
        2*x(6)*t09.*r2, 2*x(7)*t10.*r3, 2*x(8)*t11.*r4];
    
    gradf = 2*J'*fvec;
end

end