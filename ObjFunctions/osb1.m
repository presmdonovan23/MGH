function [f,gradf,fvec,J] = osb1(n,m,x,evalDer)
% Osborne 1 function (17)
% --------------------------------------
% Dimensions: n = 5, m = 33
% Standard starting point: (0.5,1.5,-1,0.01,0.02)
% Minima: f = 5.46489...10^(-5)
%   at (.3754,1.9358,-1.4647,0.01287,0.02212)
%
% 2017-03-31 by Preston Donovan

J = [];
gradf = [];

t = 10*(0:m-1)';
        
y = [0.844	0.908	0.932	0.936	0.925	0.908	0.881	0.850 ...
     0.818	0.784	0.751	0.718	0.685	0.658	0.628	0.603 ...
     0.580	0.558	0.538	0.522	0.506	0.490	0.478	0.467 ...
     0.457	0.448	0.438	0.431	0.424	0.420	0.414	0.411   0.406]';

fvec = y - (x(1) + x(2)*exp(-t*x(4)) + x(3)*exp(-t*x(5)));

f = fvec' * fvec;

if evalDer == 1
                    
    e4 = exp(-x(4)*t);
    e5 = exp(-x(5)*t);
    t2 = x(2)*e4;
    t3 = x(3)*e5;

    J = [-ones(m,1) -e4 -e5 t.*t2 t.*t3];
    
    gradf = 2*J'*fvec;
end

end